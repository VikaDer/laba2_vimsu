# Лабораторная работа 2: Автоматическое слежение за человеком с помощью камеры и сервомотора
# Сикилинда Мария и Чернов Максим (БИВ225)
## Описание

Два варианта реализации системы, которая:

-   Получает изображение с камеры\
-   Распознаёт человека на изображении\
-   Управляет светодиодом (индикация обнаружения человека)\
-   Управляет сервомотором для поворота камеры так, чтобы человек
    находился по центру кадра

------------------------------------------------------------------------

# Вариант 1: Для ПК (только программная часть)

## Требования

-   Python 3.7+\
-   Веб-камера (USB)\
-   Установленные библиотеки:
    -   `opencv-python`
    -   `numpy`

## Установка

``` bash
pip install opencv-python numpy
```

## Файлы нейросети

-   `deploy.prototxt`
-   `mobilenet_iter_73000.caffemodel`

(Взята модель MobileNet SSD для Caffe)

## Запуск

``` bash
python main.py
```

## Как работает

-   Открывается окно с изображением с камеры\
-   При обнаружении человека выводится сообщение и направление, куда
    нужно повернуть камеру (влево, вправо, по центру)\
-   Сообщения выводятся только при изменении состояния
    (появление/исчезновение человека, изменение направления)

------------------------------------------------------------------------

# Вариант 2: Для Raspberry Pi (с аппаратной частью)

## Требования

-   Raspberry Pi (рекомендуется 3B+ или новее)\
-   Камера (USB или Raspberry Pi Camera Module)\
-   Сервомотор (например, SG90)\
-   Кнопка\
-   Светодиод + резистор (220--330 Ом)\
-   Провода

## Подключение

### GPIO-пины (по умолчанию)

  Устройство   GPIO (BCM)
  ------------ ------------
  Сервомотор   17
  Кнопка       27
  Светодиод    22

Можно изменить номера пинов в коде.

### Схема подключения

#### Сервомотор

-   Оранжевый (сигнал) --- **GPIO 17**\
-   Красный (VCC) --- **5V**\
-   Коричневый (GND) --- **GND**

> ⚠️ Если сервомотор мощный --- используйте отдельный источник питания!

#### Кнопка

-   Один контакт --- **GPIO 27**\
-   Второй контакт --- **GND**

#### Светодиод

-   Длинная ножка (анод) --- через резистор к **GPIO 22**\
-   Короткая ножка (катод) --- **GND**

## Установка

``` bash
pip install opencv-python numpy RPi.GPIO
```

## Файлы нейросети

-   `deploy.prototxt`
-   `mobilenet_iter_73000.caffemodel`


## Запуск

``` bash
python main_raspi.py
```

## Как работает

-   После запуска программа ждёт нажатия кнопки\
-   При нажатии:
    -   Захватывается изображение\
    -   Если человек обнаружен:
        -   Светодиод загорается\
        -   Камера поворачивается так, чтобы человек был по центру\
    -   Если человека нет:
        -   Светодиод гаснет\
-   При отпускании кнопки:
    -   Светодиод гаснет\
    -   Камера возвращается в центр\
-   Для выхода нажмите **Ctrl + C**

------------------------------------------------------------------------

# Важные нюансы

-   **Питание сервомотора:** мощные моторы нельзя питать от Raspberry
    Pi\
-   **Кнопка:** используется `PUD_UP`, поэтому второй контакт вниз на
    GND\
-   **Светодиод:** всегда с резистором\
-   **Камера:** для Raspberry Pi Camera Module может понадобиться
    включить её в `raspi-config`\
-   **Калибровка сервомотора:** углы могут требовать настройки (см.
    функцию `set_servo_angle`)

------------------------------------------------------------------------

# Примечания

-   Файлы нейросети должны лежать рядом с вашим скриптом\
-   Если используете другие GPIO --- измените их в коде\
-   Возможна необходимость калибровки сервомотора

------------------------------------------------------------------------

# Вопросы и поддержка

Если возникли вопросы по подключению или работе --- пишите!
